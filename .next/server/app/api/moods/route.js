"use strict";(()=>{var e={};e.id=827,e.ids=[827],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},81998:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>I,originalPathname:()=>w,patchFetch:()=>x,requestAsyncStorage:()=>h,routeModule:()=>y,serverHooks:()=>q,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>T});var o={};t.r(o),t.d(o,{GET:()=>g,POST:()=>f});var s=t(89462),n=t(75345),i=t(57143),a=t(92969),u=t(76388),l=t(11185),d=t.n(l);let p=new(d()).Schema({userId:{type:String,required:!0,index:!0},moodScore:{type:Number,required:!0,min:1,max:10},emotions:[{type:String,required:!0}],marketCondition:{type:String,required:!0,enum:["bullish","bearish","neutral","volatile"]},notes:{type:String,maxlength:500}},{timestamps:!0}),c=d().models.Mood||d().model("Mood",p);var m=t(80513);async function f(e){try{let r=await (0,m.q8)(e);if(console.log("Raw userId from verifyAuthToken:",r),console.log("Type of userId:",typeof r),console.log("Is userId a string?","string"==typeof r),!r)return a.Z.json({message:"Unauthorized"},{status:401});if("string"!=typeof r)return console.error("UserId is not a string, it is:",typeof r,r),a.Z.json({message:"Invalid user ID format"},{status:400});await (0,u.Z)();let{moodScore:t,emotions:o,marketCondition:s,notes:n}=await e.json();if(!t||!o||!s)return a.Z.json({message:"Missing required fields"},{status:400});console.log("About to create mood with userId:",r,"type:",typeof r);let i=await new c({userId:r,moodScore:t,emotions:o,marketCondition:s,notes:n}).save();return a.Z.json(i,{status:201})}catch(e){return console.error("Create mood error:",e),a.Z.json({message:"Internal server error"},{status:500})}}async function g(e){try{let r=await (0,m.q8)(e);if(console.log("GET - Raw userId from verifyAuthToken:",r),console.log("GET - Type of userId:",typeof r),!r)return a.Z.json({message:"Unauthorized"},{status:401});if("string"!=typeof r)return console.error("GET - UserId is not a string, it is:",typeof r,r),a.Z.json({message:"Invalid user ID format"},{status:400});await (0,u.Z)(),console.log("GET - About to query moods with userId:",r,"type:",typeof r);let t=await c.find({userId:r}).sort({createdAt:-1}).limit(30);return a.Z.json(t)}catch(e){return console.error("Get moods error:",e),a.Z.json({message:"Internal server error"},{status:500})}}let y=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/moods/route",pathname:"/api/moods",filename:"route",bundlePath:"app/api/moods/route"},resolvedPagePath:"E:\\project_qcatuy\\src\\app\\api\\moods\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:h,staticGenerationAsyncStorage:v,serverHooks:q,headerHooks:I,staticGenerationBailout:T}=y,w="/api/moods/route";function x(){return(0,i.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:v})}},80513:(e,r,t)=>{t.d(r,{RA:()=>a,q8:()=>i});var o=t(62363),s=t(87750),n=t.n(s);async function i(e){try{let r=await (0,o.getToken)({req:e,secret:process.env.NEXTAUTH_SECRET});if(!r)return null;return r.id||r.sub}catch(e){return console.error("Auth verification error:",e),null}}function a(e,r="1d"){if(!process.env.JWT_SECRET)throw Error("JWT_SECRET is not defined");return n().sign(e,process.env.JWT_SECRET,{expiresIn:r})}},76388:(e,r,t)=>{t.d(r,{Z:()=>a});var o=t(11185),s=t.n(o);let n=process.env.MONGODB_URI;if(!n)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let a=async function(){if(i.conn)return i.conn;i.promise||(i.promise=s().connect(n,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[120,284,969,750],()=>t(81998));module.exports=o})();