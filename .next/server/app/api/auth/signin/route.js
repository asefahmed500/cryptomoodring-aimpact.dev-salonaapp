"use strict";(()=>{var e={};e.id=267,e.ids=[267],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},19880:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>q,originalPathname:()=>x,patchFetch:()=>S,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>v,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>w});var n={};t.r(n),t.d(n,{POST:()=>d});var i=t(89462),s=t(75345),o=t(57143),a=t(92969),u=t(24939),l=t.n(u),p=t(76388),c=t(44631),m=t(80513);async function d(e){try{await (0,p.Z)();let{email:r,password:t}=await e.json();if(!r||!t)return a.Z.json({message:"Missing email or password"},{status:400});let n=await c.Z.findOne({email:r});if(!n||!await l().compare(t,n.password))return a.Z.json({message:"Invalid credentials"},{status:401});let i=(0,m.RA)({userId:n._id.toString(),username:n.username,email:n.email});return a.Z.json({message:"Sign in successful",token:i,user:{id:n._id,username:n.username,email:n.email}})}catch(e){return console.error("Signin error:",e),a.Z.json({message:"Internal server error"},{status:500})}}let g=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/signin/route",pathname:"/api/auth/signin",filename:"route",bundlePath:"app/api/auth/signin/route"},resolvedPagePath:"E:\\project_qcatuy\\src\\app\\api\\auth\\signin\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:f,serverHooks:v,headerHooks:q,staticGenerationBailout:w}=g,x="/api/auth/signin/route";function S(){return(0,o.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:f})}},80513:(e,r,t)=>{t.d(r,{RA:()=>a,q8:()=>o});var n=t(62363),i=t(87750),s=t.n(i);async function o(e){try{let r=await (0,n.getToken)({req:e,secret:process.env.NEXTAUTH_SECRET});if(!r)return null;return r.id||r.sub}catch(e){return console.error("Auth verification error:",e),null}}function a(e,r="1d"){if(!process.env.JWT_SECRET)throw Error("JWT_SECRET is not defined");return s().sign(e,process.env.JWT_SECRET,{expiresIn:r})}},76388:(e,r,t)=>{t.d(r,{Z:()=>a});var n=t(11185),i=t.n(n);let s=process.env.MONGODB_URI;if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose;o||(o=global.mongoose={conn:null,promise:null});let a=async function(){if(o.conn)return o.conn;o.promise||(o.promise=i().connect(s,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}},44631:(e,r,t)=>{t.d(r,{Z:()=>o});var n=t(11185),i=t.n(n);let s=new(i()).Schema({username:{type:String,required:!0,unique:!0,trim:!0,minlength:3,maxlength:20},email:{type:String,required:!0,unique:!0,trim:!0,lowercase:!0},password:{type:String,required:!0,minlength:6}},{timestamps:!0}),o=i().models.User||i().model("User",s)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[120,971,363,939,750],()=>t(19880));module.exports=n})();