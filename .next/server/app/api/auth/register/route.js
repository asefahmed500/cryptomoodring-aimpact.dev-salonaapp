"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},64506:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>q,originalPathname:()=>x,patchFetch:()=>y,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>v,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>w});var s={};t.r(s),t.d(s,{POST:()=>d});var n=t(89462),a=t(75345),i=t(57143),o=t(92969),u=t(24939),l=t.n(u),p=t(76388),c=t(44631),m=t(80513);async function d(e){try{await (0,p.Z)();let{username:r,email:t,password:s}=await e.json();if(!r||!t||!s)return o.Z.json({message:"All fields are required"},{status:400});if(s.length<6)return o.Z.json({message:"Password must be at least 6 characters"},{status:400});if(await c.Z.findOne({$or:[{email:t},{username:r}]}))return o.Z.json({message:"User already exists"},{status:409});let n=await l().hash(s,12),a=new c.Z({username:r,email:t,password:n});await a.save();let i=(0,m.RA)({userId:a._id.toString(),username:a.username,email:a.email});return o.Z.json({user:{id:a._id,username:a.username,email:a.email},token:i},{status:201})}catch(e){return console.error("Registration error:",e),o.Z.json({message:"Internal server error"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"E:\\project_qcatuy\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:v,headerHooks:q,staticGenerationBailout:w}=h,x="/api/auth/register/route";function y(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:f})}},80513:(e,r,t)=>{t.d(r,{RA:()=>o,q8:()=>i});var s=t(62363),n=t(87750),a=t.n(n);async function i(e){try{let r=await (0,s.getToken)({req:e,secret:process.env.NEXTAUTH_SECRET});if(!r)return null;return r.id||r.sub}catch(e){return console.error("Auth verification error:",e),null}}function o(e,r="1d"){if(!process.env.JWT_SECRET)throw Error("JWT_SECRET is not defined");return a().sign(e,process.env.JWT_SECRET,{expiresIn:r})}},76388:(e,r,t)=>{t.d(r,{Z:()=>o});var s=t(11185),n=t.n(s);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let o=async function(){if(i.conn)return i.conn;i.promise||(i.promise=n().connect(a,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}},44631:(e,r,t)=>{t.d(r,{Z:()=>i});var s=t(11185),n=t.n(s);let a=new(n()).Schema({username:{type:String,required:!0,unique:!0,trim:!0,minlength:3,maxlength:20},email:{type:String,required:!0,unique:!0,trim:!0,lowercase:!0},password:{type:String,required:!0,minlength:6}},{timestamps:!0}),i=n().models.User||n().model("User",a)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[120,971,363,939,750],()=>t(64506));module.exports=s})();