"use strict";(()=>{var e={};e.id=6,e.ids=[6],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25528:e=>{e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},66394:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>x,originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>q});var n={};t.r(n),t.d(n,{GET:()=>l,POST:()=>p});var i=t(89462),s=t(75345),o=t(57143),a=t(92969),u=t(90619),c=t(76388),d=t(33828);async function p(e){try{await (0,c.Z)();let r=await (0,u.getServerSession)();if(!r?.user?.email)return a.Z.json({message:"Unauthorized"},{status:401});let{symbol:t,direction:n,confidence:i,targetPrice:s,timeframe:o,reasoning:p}=await e.json();if(!t||!n||!i||!o||!p)return a.Z.json({message:"Missing required fields: symbol, direction, confidence, timeframe, reasoning"},{status:400});if(!["up","down"].includes(n))return a.Z.json({message:'Direction must be either "up" or "down"'},{status:400});if(i<1||i>10)return a.Z.json({message:"Confidence must be between 1 and 10"},{status:400});if(!["1h","4h","1d","1w","1m"].includes(o))return a.Z.json({message:"Invalid timeframe"},{status:400});let l=await d.Z.create({userId:r.user.email,symbol:t.toUpperCase(),direction:n,confidence:parseInt(i),targetPrice:s?parseFloat(s):void 0,timeframe:o,reasoning:p.trim()});return a.Z.json(l,{status:201})}catch(e){return console.error("Create prediction error:",e),a.Z.json({message:"Internal server error"},{status:500})}}async function l(e){try{await (0,c.Z)();let e=await (0,u.getServerSession)();if(!e?.user?.email)return a.Z.json({message:"Unauthorized"},{status:401});let r=await d.Z.find({userId:e.user.email}).sort({createdAt:-1}).limit(50).lean();return a.Z.json(r)}catch(e){return console.error("Get predictions error:",e),a.Z.json({message:"Internal server error"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/predictions/route",pathname:"/api/predictions",filename:"route",bundlePath:"app/api/predictions/route"},resolvedPagePath:"E:\\project_qcatuy\\src\\app\\api\\predictions\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:f,headerHooks:x,staticGenerationBailout:q}=m,y="/api/predictions/route";function v(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}},76388:(e,r,t)=>{t.d(r,{Z:()=>a});var n=t(11185),i=t.n(n);let s=process.env.MONGODB_URI;if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose;o||(o=global.mongoose={conn:null,promise:null});let a=async function(){if(o.conn)return o.conn;o.promise||(o.promise=i().connect(s,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}},33828:(e,r,t)=>{t.d(r,{Z:()=>o});var n=t(11185),i=t.n(n);let s=new(i()).Schema({userId:{type:String,required:!0,index:!0},symbol:{type:String,required:!0,uppercase:!0,trim:!0},direction:{type:String,required:!0,enum:["up","down"]},confidence:{type:Number,required:!0,min:1,max:10},targetPrice:{type:Number,required:!1,min:0},timeframe:{type:String,required:!0,enum:["1h","4h","1d","1w","1m"]},reasoning:{type:String,required:!0,maxlength:1e3,trim:!0},status:{type:String,default:"pending",enum:["pending","correct","incorrect"]},actualPrice:{type:Number,required:!1,min:0},resolvedAt:{type:Date,required:!1}},{timestamps:!0});s.index({userId:1,createdAt:-1}),s.index({userId:1,status:1}),s.index({userId:1,symbol:1}),s.virtual("isResolved").get(function(){return"pending"!==this.status}),s.methods.calculateCorrectness=function(e){return this.targetPrice?"up"===this.direction?e>=this.targetPrice:e<=this.targetPrice:null};let o=i().models.Prediction||i().model("Prediction",s)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[120,971,363,619],()=>t(66394));module.exports=n})();